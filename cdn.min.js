<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sterowanie Piecem Peletowym ESP32</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Tutaj umieść cały swój kod CSS */
        /* Ten blok style powinien być zaraz pod linkiem do font-awesome */
        :root{--primary:#2c3e50;--secondary:#3498db;--danger:#e74c3c;--warning:#f39c12;--success:#2ecc71;--dark:#1a252f;--flame-on:#ff5722;--flame-off:#808080;--feeder-forward-color:#ffa500;--feeder-pause-color:#808080;--blower-color:#00bfff;--sensor-ok:#2ecc71;--sensor-error:#e74c3c;--ignition-heating:#ff9800;--ignition-ready:#4CAF50;--maintenance-active:#f39c12;--maintenance-inactive:#808080;}
        body{font-family:'Arial',sans-serif;margin:0;padding:0;background-color:var(--dark);color:#ecf0f1;display:flex;flex-direction:column;min-height:100vh;}
        header{background-color:var(--primary);padding:20px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.2);position:relative;display:flex;justify-content:center;align-items:center;}
        header h1{margin:0;color:#fff;}
        .status-indicators{position:absolute;right:20px;top:50%;transform:translateY(-50%);display:flex;gap:10px;}
        .status-badge{display:flex;align-items:center;gap:5px;padding:5px 10px;border-radius:15px;font-size:0.9em;color:#fff;}
        .status-good{background-color:var(--success);}
        .status-error{background-color:var(--danger);}
        .status-icon{font-size:1.2em;}
        main{flex:1;padding:20px;display:flex;flex-wrap:wrap;gap:20px;justify-content:center;}
        .card{background-color:var(--primary);border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.3);padding:20px;width:calc(33% - 20px);box-sizing:border-box;display:flex;flex-direction:column;gap:15px;min-width:300px;}
        .card-header{font-size:1.4em;font-weight:bold;color:var(--secondary);border-bottom:1px solid rgba(255,255,255,0.1);padding-bottom:10px;margin-bottom:15px;}
        .data-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.05);}
        .data-row:last-child{border-bottom:none;}
        .label{font-weight:bold;color:#bdc3c7;}
        .value{color:#ecf0f1;font-size:1.1em;}
        .value.large{font-size:1.5em;font-weight:bold;}
        .controls-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
        .control-group{display:flex;flex-direction:column;gap:5px;}
        .control-group label{font-size:0.9em;color:#bdc3c7;}
        input[type="range"]{width:100%;height:4px;background:var(--secondary);border-radius:5px;outline:none;transition:opacity .2s;margin-top:5px;}
        input[type="range"]::-webkit-slider-thumb{width:18px;height:18px;background:var(--success);border-radius:50%;cursor:pointer;}
        input[type="range"]::-moz-range-thumb{width:18px;height:18px;background:var(--success);border-radius:50%;cursor:pointer;}
        .button-group{display:flex;gap:10px;flex-wrap:wrap;}
        button{background-color:var(--secondary);color:white;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;font-size:1em;transition:background-color 0.3s ease;}
        button:hover{background-color:#2980b9;}
        button.danger{background-color:var(--danger);}
        button.danger:hover{background-color:#c0392b;}
        button.success{background-color:var(--success);}
        button.success:hover{background-color:#27ae60;}
        button.active{background-color:var(--success)!important;}
        button.active.danger{background-color:var(--danger)!important;}
        .status-value{padding:3px 8px;border-radius:4px;font-size:0.9em;font-weight:bold;color:#fff;}
        .status-active{background-color:var(--sensor-ok);}
        .status-inactive{background-color:var(--sensor-error);}
        .status-label{font-weight:bold;color:#bdc3c7;}
        .mqtt-config input[type="text"],.mqtt-config input[type="password"]{width:calc(100% - 20px);padding:8px;margin-bottom:10px;border-radius:4px;border:1px solid rgba(255,255,255,0.1);background-color:var(--dark);color:#ecf0f1;}
        .log-container{background-color:rgba(0,0,0,0.2);max-height:150px;overflow-y:auto;border-radius:4px;padding:10px;font-family:monospace;font-size:0.8em;line-height:1.4em;}
        .log-entry{border-bottom:1px dotted rgba(255,255,255,0.05);padding:3px 0;}
        .log-entry:last-child{border-bottom:none;}
        .log-time{color:#7f8c8d;margin-right:5px;}
        .log-message.info{color:#bdc3c7;}
        .log-message.success{color:var(--success);}
        .log-message.warning{color:var(--warning);}
        .log-message.error{color:var(--danger);}
        .mqtt-log-entry{border-bottom:1px dotted rgba(255,255,255,0.05);padding:3px 0;word-break:break-all;}
        .mqtt-log-topic{font-weight:bold;color:var(--secondary);margin-right:5px;}
        .mqtt-log-message{color:#ecf0f1;}
        .mqtt-status-indicator{width:12px;height:12px;border-radius:50%;background-color:var(--danger);display:inline-block;margin-left:10px;vertical-align:middle;}
        .mqtt-status-indicator.connected{background-color:var(--success);}
        .tabs{display:flex;margin-bottom:20px;justify-content:center;}
        .tab{padding:10px 20px;background-color:var(--primary);cursor:pointer;border-top-left-radius:8px;border-top-right-radius:8px;margin-right:5px;color:#bdc3c7;font-weight:bold;transition:background-color 0.3s ease,color 0.3s ease;}
        .tab:hover{background-color:#2980b9;color:#fff;}
        .tab.active{background-color:var(--secondary);color:#fff;}
        .tab-content{display:none;width:100%;}
        .tab-content.active{display:block;}
        .chart-container{position:relative;height:400px;width:100%;max-width:900px;margin:20px auto;background-color:var(--primary);padding:15px;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.3);}
        .chart-controls{display:flex;justify-content:center;gap:10px;margin-top:15px;flex-wrap:wrap;}
        .chart-switch,.dataset-toggle,.history-btn{background-color:rgba(0,0,0,0.3);color:#ecf0f1;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:0.9em;transition:background-color 0.3s ease;}
        .chart-switch:hover,.dataset-toggle:hover,.history-btn:hover{background-color:rgba(0,0,0,0.5);}
        .chart-switch.active,.dataset-toggle.active,.history-btn.active{background-color:var(--secondary);color:#fff;}
        .chart-buttons{display:flex;justify-content:flex-end;gap:5px;margin-top:10px;}
        .chart-buttons button{background-color:rgba(0,0,0,0.3);padding:5px 10px;}
        .chart-buttons button:hover{background-color:rgba(0,0,0,0.5);}
        footer{background-color:var(--primary);color:#bdc3c7;text-align:center;padding:15px;margin-top:20px;box-shadow:0 -2px 4px rgba(0,0,0,0.2);}
        .flame-indicator,.igniter-indicator{width:20px;height:20px;border-radius:50%;display:inline-flex;justify-content:center;align-items:center;margin-left:10px;font-size:0.7em;font-weight:bold;color:#fff;}
        .flame-indicator.on{background-color:var(--flame-on);animation:pulse-flame 1s infinite;}
        .flame-indicator.off{background-color:var(--flame-off);}
        .igniter-indicator{background-color:var(--ignition-heating);animation:pulse-igniter 1s infinite;}
        .igniter-indicator.ready{background-color:var(--ignition-ready);animation:none;}
        @keyframes pulse-flame{0%,100%{box-shadow:0 0 0 0 rgba(255,87,34,0.7);}50%{box-shadow:0 0 0 10px rgba(255,87,34,0);}}
        @keyframes pulse-igniter{0%,100%{box-shadow:0 0 0 0 rgba(255,152,0,0.7);}50%{box-shadow:0 0 0 10px rgba(255,152,0,0);}}
        .ignition-status-text{font-weight:bold;}
        .ignition-status-text.off{color:var(--flame-off);}
        .ignition-status-text.heating{color:var(--ignition-heating);}
        .ignition-status-text.ready{color:var(--ignition-ready);}
        .ignition-status-text.on{color:var(--flame-on);}
        .ignition-timer-container{display:flex;align-items:center;gap:10px;margin-top:10px;justify-content:center;}
        .ignition-progress{width:100px;height:100px;border-radius:50%;position:relative;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.3);overflow:hidden;}
        .ignition-progress-circle{width:100%;height:100%;border-radius:50%;position:absolute;top:0;left:0;}
        .ignition-progress-text{position:relative;z-index:1;color:#fff;font-size:1.4em;font-weight:bold;}
        .feeder-cycle-info, .blower-purge-info{display:flex;align-items:center;gap:10px;margin-top:5px;flex-wrap:wrap;}
        .feeder-cycle-status, .blower-purge-status{padding:3px 8px;border-radius:4px;font-size:0.9em;font-weight:bold;color:#fff;}
        .feeder-cycle-status.on{background-color:var(--feeder-forward-color);}
        .feeder-cycle-status.off{background-color:var(--feeder-pause-color);}
        .blower-purge-status.on{background-color:var(--blower-color);}
        .blower-purge-status.off{background-color:var(--flame-off);}
        .feeder-cycle-bar-container, .blower-purge-bar-container{flex-grow:1;height:10px;background-color:rgba(0,0,0,0.3);border-radius:5px;overflow:hidden;}
        .feeder-cycle-progress-bar, .blower-purge-progress-bar{height:100%;background:linear-gradient(90deg,var(--feeder-forward-color) 0%,var(--feeder-pause-color) 0%);border-radius:5px;}
        .mode-info-box{background-color:rgba(0,0,0,0.2);padding:8px;border-radius:5px;margin-top:10px;display:flex;align-items:center;gap:10px;}
        .mode-info-box .mode-label{font-weight:bold;color:#bdc3c7;}
        .mode-info-box .mode-value{color:#ecf0f1;font-weight:bold;}
        .mode-info-box.mode-direct{border:1px solid var(--blower-color);color:var(--blower-color);}
        .mode-info-box.mode-inverter{border:1px solid #9b59b6;color:#9b59b6;}
        .mode-info-box.maintenance-active{border:1px solid var(--maintenance-active);color:var(--maintenance-active);}
        .mode-info-box.maintenance-inactive{border:1px solid var(--maintenance-inactive);color:var(--maintenance-inactive);}
        .maintenance-status-indicator{display:inline-block;padding:3px 8px;border-radius:4px;font-size:0.9em;font-weight:bold;}
        #current-ignition-temp{font-weight:bold;color:#fff;margin-top:5px;}
        .gauge-container{width:120px;height:60px;position:relative;overflow:hidden;margin:10px auto;border-bottom-left-radius:60px;border-bottom-right-radius:60px;background-color:rgba(0,0,0,0.3);}
        .gauge-fill{position:absolute;bottom:0;left:0;width:100%;height:0;background-color:var(--success);transform-origin:bottom;transition:height 0.5s ease-out;}
        .gauge-label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:bold;font-size:1.1em;text-align:center;width:100%;}
    </style>
</head>
<body>
    <header>
        <h1>Sterowanie Piecem Peletowym</h1>
        <div class="status-indicators">
            <span id="wifiStatusBadge" class="status-badge status-error"><i class="fas fa-wifi status-icon"></i> <span id="wifiStatusText">Łączenie WiFi...</span></span>
            <span id="mqttStatusBadge" class="status-badge status-error"><i class="fas fa-cloud-upload-alt status-icon"></i> <span id="mqttStatusTextDiagram">Rozłączono MQTT</span></span>
            <span id="espStatusBadge" class="status-badge status-error"><i class="fas fa-microchip status-icon"></i> <span id="espStatusText">Offline</span></span>
        </div>
    </header>

    <main>
        <div class="tabs">
            <div class="tab active" data-tab="status-tab">Status</div>
            <div class="tab" data-tab="control-tab">Sterowanie</div>
            <div class="tab" data-tab="settings-tab">Ustawienia</div>
            <div class="tab" data-tab="chart-tab">Wykresy</div>
            <div class="tab" data-tab="history-tab">Historia & Statystyki</div>
            <div class="tab" data-tab="mqtt-tab">Ustawienia MQTT</div>
            <div class="tab" data-tab="logs-tab">Logi Aplikacji</div>
        </div>

        <div id="status-tab" class="tab-content active">
            <div class="card">
                <div class="card-header">Stan Kotła</div>
                <div class="data-row"><span class="label">Temp. Kotła:</span><span id="boilerTemp" class="value large">--.-</span>°C</div>
                <div class="data-row"><span class="label">Temp. Spalin:</span><span id="exhaustTemp" class="value">--.-</span>°C</div>
                <div class="data-row"><span class="label">Temp. Docelowa:</span><span id="targetTempDisplay" class="value">--</span>°C</div>
                <div class="data-row"><span class="label">Tryb:</span><span id="currentMode" class="value">--</span></div>
                <div class="data-row"><span class="label">Płomień:</span><span id="flameStatus" class="value">Brak</span><span id="flame-indicator" class="flame-indicator off"></span></div>
                <div class="data-row">
                    <span class="label">Rozpalanie:</span>
                    <span class="value">
                        <span id="ignition-status-text" class="ignition-status-text off">Wyłączony</span>
                        <span id="igniter-indicator" class="igniter-indicator" style="display:none;"></span>
                    </span>
                </div>
                <div id="ignition-timer" class="ignition-timer-container" style="display:none;">
                    <div id="ignition-progress" class="ignition-progress">
                        <div id="ignition-progress-circle" class="ignition-progress-circle"></div>
                        <span id="ignition-progress-text" class="ignition-progress-text">0%</span>
                    </div>
                    <div>
                        <span id="ignition-countdown">--:--</span>
                        <div id="current-ignition-temp" style="display:none;">Akt. temp: --°C</div>
                    </div>
                </div>
                <div class="data-row"><span class="label">Moc Dmuchawy:</span><span id="blowerPower" class="value">--</span>%</div>
                <div class="data-row"><span class="label">Obroty Dmuchawy:</span><span id="blowerRPM" class="value">--</span> RPM</div>
                <div class="data-row"><span class="label">Moc Grzałki:</span><span id="igniterPower" class="value">--</span>%</div>
                <div class="data-row"><span class="label">Korekta Temp:</span><span id="tempCorrectionDisplay" class="value">0.0</span>°C</div>
                <div class="data-row"><span class="label">Feeder Cykl:</span>
                    <span class="feeder-cycle-info">
                        <span id="feederCycleStatus" class="feeder-cycle-status off">Brak Cyklu</span>
                        <div class="feeder-cycle-bar-container">
                            <div id="feederCycleProgressBar" class="feeder-cycle-progress-bar"></div>
                        </div>
                        <span id="feederCycleInfo">--s / --s</span>
                    </span>
                </div>
                 <div class="data-row"><span class="label">Przedmuch:</span>
                    <span class="blower-purge-info">
                        <span id="blowerPurgeStatus" class="blower-purge-status off">Wyłączony</span>
                         <div class="blower-purge-bar-container">
                            <div id="blowerPurgeProgressBar" class="blower-purge-progress-bar"></div>
                        </div>
                        <span id="blowerPurgeInfo">--s / --s</span>
                    </span>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Stan Urządzeń</div>
                <div class="data-row"><span class="status-label">Czujnik Kotła:</span><span id="boilerSensorStatus" class="status-value status-inactive">Błąd</span></div>
                <div class="data-row"><span class="status-label">Czujnik Spalin:</span><span id="exhaustSensorStatus" class="status-value status-inactive">Błąd</span></div>
                <div class="data-row"><span class="status-label">Grzałka:</span><span id="igniterStatus" class="status-value status-inactive">Wył.</span></div>
                <div class="data-row"><span class="status-label">Dmuchawa:</span><span id="blowerStatusDevice" class="status-value status-inactive">Wył.</span></div>
                <div class="data-row"><span class="status-label">Podajnik:</span><span id="feederStatus" class="status-value status-inactive">Wył.</span></div>
                <div class="data-row"><span class="status-label">Tryb Serwisowy:</span>
                     <span id="maintenanceModeIndicator" class="maintenance-status-indicator maintenance-inactive">Nieaktywny</span>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Informacje Systemowe</div>
                <div class="data-row"><span class="label">Czas Pracy Palnika:</span><span id="burnerHoursTotal" class="value">--</span> min</div>
                <div class="data-row"><span class="label">Sygnał WiFi:</span><span id="wifiRSSI" class="value">--</span> dBm</div>
                <div class="data-row"><span class="label">Czas Działania:</span><span id="operatingTime" class="value">--</span> min</div>
                <div class="data-row"><span class="label">Ponowne Połączenia:</span><span id="reconnectCount" class="value">--</span></div>
            </div>
        </div>

        <div id="control-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Sterowanie Główne</div>
                <div class="control-group">
                    <label for="targetTempSlider">Temperatura Docelowa: <span id="targetTempDisplay">--</span>°C</label>
                    <input type="range" id="targetTempSlider" min="40" max="80" value="60">
                </div>
                <div class="button-group">
                    <button id="modeOff" class="danger">Wyłącz</button>
                    <button id="modeManual">Manualny</button>
                    <button id="modeAuto">Automatyczny</button>
                </div>
                <div class="button-group">
                    <button id="igniteButton" class="success">Rozpal</button>
                    <input type="number" id="ignitionTime" value="60" min="10" max="300" placeholder="Czas rozpalania (s)">
                    <input type="number" id="stabilizationTime" value="30" min="10" max="300" placeholder="Czas stabilizacji (s)">
                </div>
                <button id="stopBurnerButton" class="danger">Zgaś Palnik</button>
            </div>

            <div class="card">
                <div class="card-header">Sterowanie Dmuchawą (Tryb Manualny)</div>
                <div class="control-group">
                    <label for="fanPowerSlider">Moc Dmuchawy: <span id="fanPowerDisplay">--</span>%</label>
                    <input type="range" id="fanPowerSlider" min="0" max="100" value="50">
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="blowerManualControlToggle">
                    <span class="slider round"></span>
                </label>
                <span style="margin-left: 10px;">Sterowanie Dmuchawą Manualne</span>
                <div id="blowerControlModeInfo" class="mode-info-box">
                    <span class="mode-label">Tryb pracy:</span>
                    <span id="blowerControlModeText" class="mode-value">OFF</span>
                </div>
                <div class="button-group">
                    <button id="blowerManualControlModeOff" class="danger">Wyłącz</button>
                    <button id="blowerManualControlModeDirect">Bezpośredni</button>
                    <button id="blowerManualControlModeInverter">Inwerter</button>
                </div>
                <div class="control-group">
                    <label for="blowerWorkPowerSlider">Moc Dmuchawy w pracy: <span id="blowerWorkPowerDisplay">--</span>%</label>
                    <input type="range" id="blowerWorkPowerSlider" min="0" max="100" value="50">
                </div>
            </div>

            <div class="card">
                <div class="card-header">Sterowanie Podajnikiem (Tryb Manualny)</div>
                <div class="control-group">
                    <label for="feederSpeedSlider">Czas podawania: <span id="feederSpeedDisplay">--</span>s</label>
                    <input type="range" id="feederSpeedSlider" min="1" max="10" value="3">
                </div>
            </div>
        </div>

        <div id="settings-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Korekta Temperatury</div>
                <div class="control-group">
                    <label for="tempCorrectionInput">Korekta Temperatury Kotła (°C):</label>
                    <input type="number" id="tempCorrectionInput" step="0.1" value="0.0">
                    <button id="setTempCorrectionBtn">Ustaw Korektę</button>
                </div>
            </div>
            <div class="card">
                <div class="card-header">Auto-Czyszczenie</div>
                <label class="toggle-switch" style="margin-bottom: 10px;">
                    <input type="checkbox" id="autoCleanToggle">
                    <span class="slider round"></span>
                </label>
                <span style="margin-left: 10px;">Włącz Auto-Czyszczenie</span>
                <div class="control-group">
                    <label for="cleanIntervalHours">Interwał (godziny):</label>
                    <input type="number" id="cleanIntervalHours" min="1" max="24" value="8">
                </div>
                <div class="control-group">
                    <label for="cleanDurationMinutes">Czas trwania (minuty):</label>
                    <input type="number" id="cleanDurationMinutes" min="1" max="30" value="5">
                </div>
                <div class="control-group">
                    <label for="cleanBlowerPower">Moc Dmuchawy (%):</label>
                    <input type="number" id="cleanBlowerPower" min="10" max="100" value="70">
                </div>
                <button id="updateCleanBtn">Zapisz Ustawienia Czyszczenia</button>
            </div>

             <div class="card">
                <div class="card-header">Tryb Serwisowy</div>
                <label class="toggle-switch" style="margin-bottom: 10px;">
                    <input type="checkbox" id="maintenanceModeToggle">
                    <span class="slider round"></span>
                </label>
                <span style="margin-left: 10px;">Włącz Tryb Serwisowy</span>
                <div id="maintenanceFeedOnTimeSliderContainer" class="control-group" style="display:none;">
                    <label for="maintenanceFeedOnTime">Czas podawania (ON): <span id="maintenanceFeedOnTimeDisplay">--</span>s</label>
                    <input type="range" id="maintenanceFeedOnTime" min="0" max="60" value="5">
                </div>
                <div id="maintenanceFeedOffTimeSliderContainer" class="control-group" style="display:none;">
                    <label for="maintenanceFeedOffTime">Czas przerwy (OFF): <span id="maintenanceFeedOffTimeDisplay">--</span>s</label>
                    <input type="range" id="maintenanceFeedOffTime" min="0" max="60" value="10">
                </div>
                <div id="blowerMaintenanceManualPowerSliderContainer" class="control-group" style="display:none;">
                    <label for="blowerMaintenanceManualPower">Moc dmuchawy (serwis): <span id="blowerMaintenanceManualPowerDisplay">--</span>%</label>
                    <input type="range" id="blowerMaintenanceManualPower" min="0" max="100" value="50">
                </div>
            </div>

            <div class="card">
                <div class="card-header">Sterowanie Przedmuchem</div>
                <div class="control-group">
                    <label for="blowerPurgeOnTime">Czas przedmuchu (ON - s):</label>
                    <input type="number" id="blowerPurgeOnTime" min="1" max="60" value="10">
                </div>
                <div class="control-group">
                    <label for="blowerPurgeOffTime">Czas przerwy przedmuchu (OFF - s):</label>
                    <input type="number" id="blowerPurgeOffTime" min="1" max="60" value="20">
                </div>
                 <div class="control-group">
                    <label for="blowerPurgeManualPowerSlider">Moc dmuchawy podczas przedmuchu: <span id="blowerPurgeManualPowerDisplay">--</span>%</label>
                    <input type="range" id="blowerPurgeManualPowerSlider" min="0" max="100" value="70">
                </div>
                <div id="blowerPurgeModeInfo" class="mode-info-box">
                    <span class="mode-label">Tryb przedmuchu:</span>
                    <span id="blowerPurgeModeText" class="mode-value">OFF</span>
                </div>
                <div class="button-group">
                    <button id="blowerPurgeModeOff">Wyłącz</button>
                    <button id="blowerPurgeModeDirect">Bezpośredni</button>
                    <button id="blowerPurgeModeInverter">Inwerter</button>
                </div>
            </div>
        </div>

        <div id="chart-tab" class="tab-content">
            <div class="chart-container">
                <canvas id="myChart"></canvas>
            </div>
            <div class="chart-controls">
                <div class="chart-switcher">
                    <button class="chart-switch active" data-chart="live">Live</button>
                    <button class="chart-switch" data-chart="day">Dzień</button>
                    <button class="chart-switch" data-chart="week">Tydzień</button>
                    <button class="chart-switch" data-chart="month">Miesiąc</button>
                </div>
                <div class="dataset-toggles">
                    <button class="dataset-toggle active" data-dataset="boilerTemp">Temp. Kotła</button>
                    <button class="dataset-toggle active" data-dataset="exhaustTemp">Temp. Spalin</button>
                    <button class="dataset-toggle active" data-dataset="targetTemp">Temp. Docelowa</button>
                </div>
                <div class="chart-buttons">
                    <button id="zoomInBtn"><i class="fas fa-search-plus"></i> Zoom In</button>
                    <button id="zoomOutBtn"><i class="fas fa-search-minus"></i> Zoom Out</button>
                    <button id="resetZoomBtn"><i class="fas fa-arrows-alt"></i> Reset Zoom</button>
                </div>
            </div>
            <div class="card" style="margin-top: 20px; max-width: 900px; width: 100%;">
                <div class="card-header">Log Wykresów</div>
                <div id="chartLog" class="log-container"></div>
            </div>
        </div>

        <div id="history-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Statystyki</div>
                 <div class="button-group history-range-btns">
                    <button class="history-btn active" data-range="day">Dziś</button>
                    <button class="history-btn" data-range="week">Ostatni Tydzień</button>
                    <button class="history-btn" data-range="month">Ostatni Miesiąc</button>
                </div>
                <div class="data-row"><span class="label">Czas pracy palnika:</span><span id="historyBurnerTime" class="value">--</span> min</div>
                <div class="data-row"><span class="label">Zużycie pelletu:</span><span id="historyPelletConsumption" class="value">--</span> kg</div>
                <div class="data-row"><span class="label">Średnia moc dmuchawy:</span><span id="historyAvgBlowerPower" class="value">--</span>%</div>
                <div class="data-row"><span class="label">Średnia temp. kotła:</span><span id="historyAvgBoilerTemp" class="value">--</span>°C</div>
            </div>

            <div class="card">
                <div class="card-header">Szacunkowe Koszty</div>
                <div class="control-group">
                    <label for="pelletPriceInput">Cena pelletu (PLN/kg):</label>
                    <input type="number" id="pelletPriceInput" step="0.01" value="1.50" min="0">
                </div>
                <div class="data-row"><span class="label">Szacunkowe zużycie:</span><span id="estimatedConsumption">--</span> kg/h</div>
                <div class="data-row"><span class="label">Szacunkowy koszt:</span><span id="estimatedCostDisplay">--</span> PLN/h</div>
                <div class="data-row"><span class="label">Całkowity koszt:</span><span id="totalCalculatedCost">--</span> PLN</div>
                <div class="data-row"><span class="label">Efektywność (%):</span>
                    <div class="gauge-container">
                        <div id="efficiencyGaugeFill" class="gauge-fill"></div>
                        <span id="efficiencyGaugeLabel" class="gauge-label">--%</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Resetowanie Danych</div>
                <button id="resetStatisticsButton" class="danger">Resetuj Statystyki</button>
                <button id="resetAllDataButton" class="danger">Resetuj WSZYSTKIE Dane</button>
            </div>
        </div>

        <div id="mqtt-tab" class="tab-content">
            <div class="card mqtt-config">
                <div class="card-header">Ustawienia MQTT</div>
                <label for="mqttBroker">Broker MQTT:</label>
                <input type="text" id="mqttBroker" value="broker.emqx.io" placeholder="np. broker.emqx.io">
                <label for="mqttPort">Port (WebSockets):</label>
                <input type="text" id="mqttPort" value="8083" placeholder="np. 8083">
                <label for="mqttUser">Użytkownik:</label>
                <input type="text" id="mqttUser" value="agentsan007" placeholder="opcjonalnie">
                <label for="mqttPassword">Hasło:</label>
                <input type="password" id="mqttPassword" value="Sanders24*" placeholder="opcjonalnie">
                <label for="mqttTopicState">Temat Stanu (State Topic):</label>
                <input type="text" id="mqttTopicState" value="pellet/boiler/state" placeholder="np. pellet/boiler/state">
                <label for="mqttTopicControl">Temat Kontrolny (Control Topic):</label>
                <input type="text" id="mqttTopicControl" value="pellet/boiler/control" placeholder="np. pellet/boiler/control">
                <div class="button-group">
                    <button id="mqttConnectBtn" class="success">Połącz MQTT</button>
                    <button id="mqttDisconnectBtn" class="danger">Rozłącz MQTT</button>
                </div>
                <div class="data-row">
                    <span class="label">Status Połączenia:</span>
                    <span id="mqttStatusText" class="value">Rozłączono</span>
                    <span class="mqtt-status-indicator" id="mqttStatusIndicator"></span>
                </div>
            </div>
        </div>

        <div id="logs-tab" class="tab-content">
            <div class="card">
                <div class="card-header">Logi Aplikacji</div>
                <div id="appLog" class="log-container"></div>
            </div>
            <div class="card">
                <div class="card-header">Logi MQTT</div>
                <div id="mqttLog" class="log-container"></div>
            </div>
        </div>

    </main>

    <footer>
        <p>&copy; 2024 Sterowanie Piecem Peletowym. Wszelkie prawa zastrzeżone.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1"></script>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

    <script src="cdn.min.js"></script>

    </body>
</html>
